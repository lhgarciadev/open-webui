# Fase 5.3 - Ejecutar UX de Costos y Curación en Cognitia

## Objetivo

Activar la experiencia educativa de costos en COP y la curación de modelos en el selector de Cognitia.

## Contexto

- El backend incluye cache de precios con pricepertoken (MCP)
- El selector muestra costos en COP y reduce ruido con lista curada
- Los modelos `cognitia_llm_*` se tratan como locales
- Modelos especiales (audio/realtime/imagen/search) quedan ocultos por defecto y se ven con “Ver todos”

## Prompt de Ejecución

```
Implementa la UX de costos y curación en Cognitia:

1. ACTUALIZAR CÓDIGO:

   # Desde el repo principal
   git pull

2. CONFIGURAR VARIABLES DE ENTORNO (backend):

   # En Railway o entorno local, agregar:
   PRICEPERTOKEN_MCP_URL=https://api.pricepertoken.com/mcp/mcp
   PRICING_REFRESH_INTERVAL_SECONDS=43200   # 12h
   PRICING_CACHE_TTL_SECONDS=86400          # 24h

3. APLICAR MIGRACIONES:

   # Si usas migraciones automáticas
   ENABLE_DB_MIGRATIONS=true

   # Reiniciar backend para aplicar la migración

4. VERIFICAR ENDPOINT DE DEBUG (solo admin):

   TOKEN="<TOKEN_ADMIN>"
   curl -H "Authorization: Bearer $TOKEN" \
     "https://<TU_HOST>/api/v1/pricing/debug/sample?limit=1"

   # Esperado: keys + sample con campos reales

5. TRIGGER DE REFRESH (on-demand):

   curl -H "Authorization: Bearer $TOKEN" \
     -H "Content-Type: application/json" \
     -d '{"model_ids": ["gpt-4o", "gpt-5", "cognitia_llm_zerogpu.qwen2.5-7b"]}' \
     "https://<TU_HOST>/api/v1/pricing/refresh"

6. CONFIRMAR ENDPOINT DE PRECIOS:

   curl -H "Authorization: Bearer $TOKEN" \
     "https://<TU_HOST>/api/v1/pricing/models" | jq '.items[0]'

7. REINICIAR FRONTEND:

   # Si aplica despliegue separado, refrescar el frontend

Entrega:
- Variables de entorno aplicadas
- Migración aplicada
- Endpoint /pricing/debug/sample funcionando
- Endpoint /pricing/models con items
```

## Checklist de Ejecución

```
[ ] Variables de entorno configuradas
[ ] Migración aplicada
[ ] /api/v1/pricing/debug/sample responde
[ ] /api/v1/pricing/models responde
[ ] Frontend actualizado
```

## Tiempo Estimado

| Paso             | Tiempo        |
| ---------------- | ------------- |
| Config + restart | 5-10 min      |
| Verificaciones   | 5-10 min      |
| **Total**        | **10-20 min** |
