# Etapa 4.3 - Implementar Temas con Backgrounds Apropiados

## Objetivo

Corregir el sistema de temas de Reveal.js para que cada tema incluya un background coherente, garantizando legibilidad en todos los casos.

## Problema Actual

El selector de temas actual solo modifica colores de texto y elementos decorativos, pero el fondo permanece fijo (`#0f172a`). Esto causa:

- Tema "light" con fondo oscuro = texto claro ilegible
- Inconsistencia visual al cambiar temas
- UX confusa para el usuario

## Prompt de Ejecucion

```
Implementa un sistema de temas completo para Reveal.js presentations:

1. ANALIZAR CODIGO ACTUAL:
   - Leer `backend/open_webui/tools/presentations.py`
   - Identificar donde se definen colores en REVEALJS_TEMPLATE
   - Identificar donde se usa BRAND_COLORS

2. CREAR CONFIGURACION DE TEMAS:

   Definir 3 temas completos:

   THEME_CONFIGS = {
       "dark": {
           "name": "Dark (Default)",
           "background": "#0f172a",       # Slate 900
           "surface": "#1e293b",           # Slate 800
           "text_primary": "#f8fafc",      # Slate 50
           "text_secondary": "#94a3b8",    # Slate 400
           "heading": "#ffffff",
           "accent": "#3b82f6",            # Blue 500
           "accent_light": "#60a5fa",      # Blue 400
           "gradient_start": "#60a5fa",
           "gradient_end": "#3b82f6",
       },
       "light": {
           "name": "Light",
           "background": "#ffffff",        # White
           "surface": "#f8fafc",           # Slate 50
           "text_primary": "#0f172a",      # Slate 900
           "text_secondary": "#475569",    # Slate 600
           "heading": "#1e293b",           # Slate 800
           "accent": "#3b82f6",            # Blue 500
           "accent_light": "#2563eb",      # Blue 600
           "gradient_start": "#3b82f6",
           "gradient_end": "#1e40af",
       },
       "corporate": {
           "name": "Corporate Blue",
           "background": "#1e40af",        # Blue 800
           "surface": "#1e3a8a",           # Blue 900
           "text_primary": "#ffffff",      # White
           "text_secondary": "#bfdbfe",    # Blue 200
           "heading": "#ffffff",
           "accent": "#fbbf24",            # Amber 400
           "accent_light": "#fcd34d",      # Amber 300
           "gradient_start": "#3b82f6",
           "gradient_end": "#1e40af",
       }
   }

3. ACTUALIZAR TEMPLATE CSS:

   Modificar el bloque de CSS variables para usar el tema seleccionado:

   :root {
       --r-background-color: {background};
       --r-main-color: {text_primary};
       --r-heading-color: {heading};
       /* ... resto de variables ... */
   }

   body, .reveal {
       background-color: var(--r-background-color);
   }

4. AGREGAR PARAMETRO DE TEMA:

   Modificar la firma de generate_presentation():

   async def generate_presentation(
       title: str,
       slides: Optional[List[Dict]] = None,
       author: str = "Cognitia AI",
       theme: str = "dark",  # NUEVO: "dark" | "light" | "corporate"
       __request__: Optional[Request] = None
   ) -> str:

5. ACTUALIZAR ESTILOS POR TEMA:

   Asegurar que TODOS los elementos respeten el tema:
   - Backgrounds de slides
   - Colores de texto
   - Bordes y sombras
   - Stat cards
   - Footers
   - Progress bar

6. VALIDAR CONTRASTE:

   Para cada tema, verificar:
   - Heading sobre background: ratio >= 4.5:1
   - Body text sobre background: ratio >= 4.5:1
   - Accent elements visibles

7. ACTUALIZAR DOCSTRING:

   Documentar el nuevo parametro theme en la funcion

Entrega:
- Archivo presentations.py modificado
- Test de generacion con cada tema
- Screenshots de los 3 temas
```

## Especificacion Tecnica

### Estructura de Temas

```python
THEME_CONFIGS = {
    "dark": {
        "name": "Dark (Default)",
        "background": "#0f172a",
        "surface": "#1e293b",
        "text_primary": "#f8fafc",
        "text_secondary": "#94a3b8",
        "heading": "#ffffff",
        "accent": "#3b82f6",
        "accent_light": "#60a5fa",
        "accent_dark": "#1e40af",
        "success": "#22c55e",
        "card_bg": "rgba(30, 41, 59, 0.8)",
        "card_border": "rgba(59, 130, 246, 0.3)",
    },
    "light": {
        "name": "Light",
        "background": "#ffffff",
        "surface": "#f1f5f9",
        "text_primary": "#0f172a",
        "text_secondary": "#475569",
        "heading": "#1e293b",
        "accent": "#3b82f6",
        "accent_light": "#60a5fa",
        "accent_dark": "#1e40af",
        "success": "#16a34a",
        "card_bg": "rgba(241, 245, 249, 0.9)",
        "card_border": "rgba(59, 130, 246, 0.4)",
    },
    "corporate": {
        "name": "Corporate Blue",
        "background": "#1e40af",
        "surface": "#1e3a8a",
        "text_primary": "#ffffff",
        "text_secondary": "#bfdbfe",
        "heading": "#ffffff",
        "accent": "#fbbf24",
        "accent_light": "#fcd34d",
        "accent_dark": "#d97706",
        "success": "#4ade80",
        "card_bg": "rgba(30, 58, 138, 0.8)",
        "card_border": "rgba(251, 191, 36, 0.4)",
    }
}
```

### Elementos CSS a Actualizar

| Elemento        | Variable CSS            | Descripcion        |
| --------------- | ----------------------- | ------------------ |
| Body background | `--r-background-color`  | Fondo principal    |
| Headings        | `--r-heading-color`     | Titulos h1, h2, h3 |
| Body text       | `--r-main-color`        | Parrafos y bullets |
| Links           | `--r-link-color`        | Enlaces            |
| Stat cards      | `.stat-card` background | Tarjetas de stats  |
| Footer          | `.slide-footer`         | Texto del footer   |
| Progress bar    | `.progress span`        | Barra de progreso  |

## Checklist de Validacion

```
CONFIGURACION
[ ] THEME_CONFIGS definido con 3 temas
[ ] Cada tema tiene todos los colores necesarios
[ ] generate_presentation() acepta parametro theme

CSS
[ ] Body background usa variable del tema
[ ] Headings usan color del tema
[ ] Text primary/secondary usan colores del tema
[ ] Stat cards tienen fondo apropiado
[ ] Footer es legible en todos los temas
[ ] Progress bar visible en todos los temas

CONTRASTE (WCAG AA)
[ ] Dark: texto legible sobre #0f172a
[ ] Light: texto legible sobre #ffffff
[ ] Corporate: texto legible sobre #1e40af

FUNCIONALIDAD
[ ] Theme "dark" funciona (default)
[ ] Theme "light" funciona
[ ] Theme "corporate" funciona
[ ] Theme invalido usa default (dark)
```

## Test de Validacion

```python
# Test cada tema
for theme in ["dark", "light", "corporate"]:
    result = await generate_presentation(
        title=f"Test Tema {theme.capitalize()}",
        slides=[
            {"type": "title", "title": f"Tema {theme}", "subtitle": "Test de legibilidad"},
            {"type": "content", "title": "Contenido", "bullets": [
                "Este texto debe ser legible",
                "Contraste apropiado con el fondo",
                "Sin problemas de visibilidad"
            ]},
            {"type": "stats", "title": "Metricas", "stats": [
                {"value": "100%", "label": "Legibilidad"},
                {"value": "4.5:1", "label": "Contraste"}
            ]},
            {"type": "closing", "title": "Gracias", "subtitle": "Todo visible!"}
        ],
        theme=theme
    )
    print(f"Theme {theme}: OK")
```

## Siguiente Paso

Ejecutar prompt 4.4 para responsividad del chat.
