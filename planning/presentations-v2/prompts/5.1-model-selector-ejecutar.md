# Prompt 5.1: Ejecutar - Selector de Modelos Agrupados

## Contexto
Estamos mejorando el selector de modelos de Cognitia para agrupar modelos por categorÃ­a de uso (Coding, Creativo, AnÃ¡lisis, RÃ¡pidos, Locales, etc.) en lugar de mostrar una lista plana.

## Documentos de Referencia
- **Plan detallado:** `planning/presentations-v2/5-model-selector-ux.md`
- **Selector actual:** `src/lib/components/chat/ModelSelector/Selector.svelte`
- **Item actual:** `src/lib/components/chat/ModelSelector/ModelItem.svelte`

## Tareas de ImplementaciÃ³n

### Fase 1: Estructura de Datos (Prioridad Alta)

1. **Crear constantes de categorÃ­as:**
   ```
   src/lib/constants/modelCategories.ts
   ```
   - Definir `ModelCategory` interface
   - Definir categorÃ­as: coding, creative, analysis, fast, local, vision, documents
   - Incluir emoji, nombre, descripciÃ³n, prioridad

2. **Crear utilidades de categorizaciÃ³n:**
   ```
   src/lib/utils/modelUtils.ts
   ```
   - FunciÃ³n `categorizeModel(model)` que retorna categorÃ­as aplicables
   - HeurÃ­sticas por nombre de modelo (coder â†’ coding, mini â†’ fast, etc.)
   - HeurÃ­sticas por provider (ollama â†’ local)
   - Fallback a categorÃ­a "general"

### Fase 2: UI de AgrupaciÃ³n (Prioridad Alta)

3. **Modificar `Selector.svelte`:**
   - Agrupar `filteredItems` por categorÃ­a
   - Renderizar secciones colapsables por categorÃ­a
   - Mantener compatibilidad con bÃºsqueda (no agrupar durante bÃºsqueda activa)
   - AÃ±adir pills de categorÃ­a como filtros rÃ¡pidos

4. **Modificar estructura visual:**
   ```svelte
   {#each categories as category}
     <div class="category-section">
       <button class="category-header">
         {category.emoji} {category.name}
         <span class="count">{modelsInCategory.length}</span>
       </button>
       {#if expanded}
         {#each modelsInCategory as model}
           <ModelItem {model} />
         {/each}
       {/if}
     </div>
   {/each}
   ```

### Fase 3: Badges de Capacidades (Prioridad Media)

5. **Modificar `ModelItem.svelte`:**
   - AÃ±adir badges visuales para:
     - Context window (ğŸ§  128K)
     - Velocidad (âš¡)
     - Precio (ğŸ’°)
     - Capacidades (ğŸ¤” reasoning, ğŸ‘ï¸ vision, ğŸ”§ tools)
   - Mantener diseÃ±o compacto

6. **Extraer capacidades del modelo:**
   - Parsear `model.info.meta` para capabilities
   - Inferir de nombre/provider cuando no hay metadata

### Fase 4: Persistencia y UX (Prioridad Baja)

7. **Guardar preferencias de usuario:**
   - CategorÃ­as expandidas/colapsadas en localStorage
   - Ãšltima categorÃ­a seleccionada

8. **Smart defaults:**
   - Si hay cÃ³digo en mensajes recientes â†’ pre-expandir "Coding"
   - Si hay imÃ¡genes â†’ pre-expandir "Vision"

## Criterios de AceptaciÃ³n

- [ ] Modelos agrupados visualmente por categorÃ­a
- [ ] CategorÃ­as colapsables con contador de modelos
- [ ] Pills de filtro rÃ¡pido por categorÃ­a
- [ ] BÃºsqueda sigue funcionando (vista plana durante bÃºsqueda)
- [ ] Badges de capacidades visibles en cada modelo
- [ ] Modelos sin categorÃ­a van a "General"
- [ ] Performance aceptable con 50+ modelos
- [ ] Mobile responsive

## Notas de ImplementaciÃ³n

- Usar la estructura de tags existente como base
- No romper funcionalidad de modelos pineados
- Mantener compatibilidad con filtro Local/External/Direct
- Considerar virtualizaciÃ³n si hay muchos modelos

## Output Esperado

Al finalizar, el selector debe mostrar:
```
[Todos] [â­Favoritos] [ğŸ’»Coding] [âš¡RÃ¡pidos] [ğŸ Locales] ...

â­ FAVORITOS (2)
  â””â”€ Claude Sonnet 4.5      ğŸ§ 128K âš¡ ğŸ”§
  â””â”€ GPT-4o                 ğŸ§ 128K ğŸ‘ï¸ ğŸ”§

ğŸ’» CODING & DESARROLLO (4)
  â””â”€ Claude Sonnet 4.5      ğŸ§ 128K âš¡ ğŸ”§
  â””â”€ DeepSeek Coder V2      ğŸ§ 32K ğŸ’°
  ...

âš¡ RÃPIDOS & ECONÃ“MICOS (3)
  â””â”€ Claude Haiku           ğŸ§ 200K âš¡âš¡ ğŸ’°ğŸ’°
  ...
```
