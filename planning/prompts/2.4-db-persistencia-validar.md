# Etapa 2.4 - Validar Persistencia de Base de Datos

## Prompt

Valida que la persistencia de datos quedo operativa y resistente a reinicios en el entorno objetivo:

1. Verificar conectividad y healthcheck de servicios:
   - PostgreSQL accesible y autenticando correctamente.
   - Redis accesible si `REDIS_URL` esta habilitada.
   - Backend reporta estado saludable.
2. Probar flujo minimo de persistencia de aplicacion:
   - Crear usuario de prueba (API/UI).
   - Crear chat/conversacion de prueba asociado al usuario.
   - Confirmar lectura posterior del mismo recurso desde backend.
3. Reiniciar servicio(s) de aplicacion:
   - Reiniciar backend (y contenedor web si aplica).
   - Reconsultar usuario y chat de prueba.
   - Confirmar que los datos persisten sin recrearlos.
4. Validar migraciones en base destino:
   - Ejecutar verificacion de version de Alembic.
   - Confirmar que la version aplicada corresponde a `head`.
5. Confirmar backup/recovery basico:
   - Evidencia de backup habilitado en proveedor/infra, o
   - Snapshot/dump manual exitoso con fecha y tamano.

Comandos de referencia (adaptar al entorno):

- `cd backend && alembic current`
- `cd backend && alembic heads`
- `docker compose ps` o `kubectl get pods`
- `pg_isready -h <host> -p <port> -U <user>`
- `redis-cli -u "$REDIS_URL" ping`
- `pg_dump "$DATABASE_URL" > /tmp/backup_validacion.sql`

Entrega:

- Resultado PASS/FAIL por cada check.
- Evidencias tecnicas (comandos y salidas relevantes resumidas, sin secretos).
- Riesgos abiertos, impacto y accion correctiva inmediata.
- Veredicto final: `PERSISTENCIA OK` o `PERSISTENCIA NO OK`.
