# Etapa 4.2 - Validacion Theme Selector UX

Fecha: 2026-02-13
Metodo: validacion funcional por inspeccion de codigo (sin captura visual automatizada en esta corrida).

## Checklist PASS/FAIL

1. Tema dark: PASS
2. Tema light: PASS
3. Tema her: PASS (con observacion)
4. Tema system (cambio de preferencia OS): FAIL

## Evidencia / Notas por estado

### 1) Tema dark - PASS
- El selector expone la opcion `dark`: `src/lib/components/chat/Settings/General.svelte:215`.
- Al seleccionar `dark`, se persiste en `localStorage` y se aplica la clase: `src/lib/components/chat/Settings/General.svelte:187`, `src/lib/components/chat/Settings/General.svelte:189`, `src/lib/components/chat/Settings/General.svelte:146`.
- El color del browser chrome (`meta theme-color`) se actualiza a `#171717`: `src/lib/components/chat/Settings/General.svelte:161`.

### 2) Tema light - PASS
- El selector expone la opcion `light`: `src/lib/components/chat/Settings/General.svelte:217`.
- `applyTheme` mapea correctamente a `light` y actualiza `meta theme-color` a `#ffffff`: `src/lib/components/chat/Settings/General.svelte:124`, `src/lib/components/chat/Settings/General.svelte:167`.

### 3) Tema her - PASS (con observacion)
- El selector expone la opcion `her`: `src/lib/components/chat/Settings/General.svelte:218`.
- Se asigna `meta theme-color` a `#983724`: `src/lib/components/chat/Settings/General.svelte:165`.
- En carga inicial se aplica clase `her` y splash especifico: `src/app.html:48`, `src/app.html:49`, `src/app.html:79`.
- Observacion UX: en `applyTheme`, el arreglo `themes` no incluye `her`, por lo que la remocion de clases previas no contempla ese estado: `src/lib/components/chat/Settings/General.svelte:18`, `src/lib/components/chat/Settings/General.svelte:137`.

### 4) Tema system (cambio de preferencia OS) - FAIL
- El selector expone la opcion `system`: `src/lib/components/chat/Settings/General.svelte:214`.
- El listener de OS change existe y cambia entre `dark/light` cuando hay evento del sistema: `src/app.html:56` a `src/app.html:66`.
- Problema principal: en bootstrap, cuando `localStorage.theme === 'system'`, se forza `dark` sin usar `prefers-color-scheme` para el estado inicial: `src/app.html:35` a `src/app.html:37`.
- `prefersDarkTheme` se calcula pero no se usa en esa rama: `src/app.html:29`.
- Impacto UX: con OS en Light + tema `system`, al recargar inicia en Dark hasta que ocurra un cambio de preferencia del sistema.

## Desktop y Mobile

- El selector vive en `Settings > General` y este modal se renderiza para ambos contextos.
- La distribucion es responsive:
  - Mobile: tabs horizontales (`flex-row`, `overflow-x-auto`): `src/lib/components/chat/SettingsModal.svelte:603`.
  - Desktop: tabs verticales (`md:flex-col`) con panel lateral: `src/lib/components/chat/SettingsModal.svelte:603`.
- Con base en esto, `dark/light/her` quedan operativos en desktop y mobile; `system` hereda el mismo defecto en ambos.
